import spacy
import pandas as pd
import matplotlib.pyplot as plot


Eng_Model = spacy.load('en_core_web_sm')

def extract_entities(datasetcolumn):
    entity_counts = {}
    for doc in Eng_Model.pipe(datasetcolumn.dropna()):
        for ent in doc.ents:
            entity_counts[ent.label_] = entity_counts.get(ent.label_, 0) + 1
    return entity_counts


Cleaned_Reference_entities = extract_entities(cleaned_reference_dataset['Testcases'])
LLaMA2_entities = extract_entities(LLaMA_df['Testcases'])
GPT_entities = extract_entities(GPT_df['Testcases'])


entity_types = list(set(ref_entities.keys()).union(llama_entities.keys(), gpt_entities.keys()))
entity_data = {
    'Reference': [Cleaned_Reference_entities.get(entity, 0) for entity in entity_types],
    'LLaMA': [LLaMA2_entities.get(entity, 0) for entity in entity_types],
    'GPT': [GPT_entities.get(entity, 0) for entity in entity_types]
}

dataframe = pd.DataFrame(entity_data, index=entity_types)


dataframe.plot(kind='bar', figsize=(16, 8), title='Distribution of Named Entity Types')
plot.xlabel('Entity Types')
plot.ylabel('Frequency')
plot.show()
